# WxPusher-Notifier WxPusher 告警通知

我们在使用 AWS 时偶尔会在管理员邮箱中收到 AWS 关于 EC2 维护信息的通知邮件，这些邮件很容易淹没在收件箱中，没有得到及时处理。很多客户希望能够更及时收到这类消息，比如从微信或是钉钉等即时通信软件收到这类消息通知。

微信或钉钉等即时通信工具均提供了消息接口，第三方应用获取授权后，通过调用这些接口即可往客户端发送消息。在 AWS 上可以在 EventBridge/Cloudwatch Event 中配置事件规则，即可以触发一个 Lambda 运行微信/钉钉接口调用的处理逻辑。讲解这方面设计的博客和技术文章也比较多了，具体可以参考附录的一些链接。

这个项目会多做一点点，提供一个无须编写代码快速部署钉钉告警通知的功能。在 Serverless Application Repository 中可以通过填入钉钉机器人接口相关的参数，即可快速部署整套钉钉告警通知的相关组件，涉及的 AWS 服务包括 EventBridge, SNS, Lambda 和 Secrets Manager 等。如下是整体的部署架构：

![整体部署架构](images/architecture.png)

为方便演示，这个应用部署时创建了两个 EventBridge 的 Rule，一个是捕获 EC2 的状态变化事件（如开关机），另一个是捕获 EC2 健康事件（如 EC2 计划维护事件）。因此部署后可以通过简单的启动或关闭 EC2 实例来检查是否可以在钉钉收到通知。
